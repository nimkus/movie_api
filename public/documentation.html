<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Documentation</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        background-color: #f4f4f4;
        padding: 20px;
      }
      h1,
      h2,
      h3 {
        color: #333;
      }
      .blue-text {
        color: blue;
      }
      code {
        background-color: #eaeaea;
        padding: 2px 4px;
        font-size: 0.9em;
        color: #333;
      }
      pre {
        background-color: #eaeaea;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
      }
      .table-container {
        background-color: #fff;
        padding: 20px;
        margin: 20px 0;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        text-align: left;
        padding: 10px;
        border-bottom: 1px solid #ddd;
      }
      th {
        background-color: #ddd;
      }
      /* Section Dividers */
      tr.section-header {
        background-color: #f4f4f4;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>Movie API Documentation</h1>
    <p>
      Welcome to the documentation for the MyFlix-Movie API. This web application provides users with access to
      information about movies, directors, and genres. Users can also sign up, log in, update their information, and
      create a list of favorite movies.
    </p>

    <h2>Table of Contents</h2>
    <ul>
      <li><a href="#app-setup">App Setup</a></li>
      <li><a href="#endpoints">Endpoints</a></li>
      <li><a href="#authentication">Authentication</a></li>
    </ul>

    <h2 id="app-setup">App Setup</h2>
    <p>
      The app uses Express, MongoDB, and various middleware for functionality such as body parsing, authentication,
      logging, and CORS.
    </p>

    <h2 id="endpoints">Endpoints</h2>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>ENDPOINTS</th>
            <th>(EXAMPLE) REQUEST PAYLOAD</th>
          </tr>
        </thead>
        <tbody>
          <!-- Login Section Header -->
          <tr class="section-header">
            <td colspan="2">Login Endpoints</td>
          </tr>
          <tr>
            <td>
              <strong>POST /login</strong><br />Allows users to log in and receive a JWT for further authentication.
            </td>
            <td>
              <pre><code>{
  "username": "johnDoe",
  "password": "Password123!"
}</code></pre>
            </td>
          </tr>

          <!-- Movies Section Header -->
          <tr class="section-header">
            <td colspan="2">Movie Endpoints</td>
          </tr>
          <tr>
            <td><strong>GET /movies</strong><br />Returns a list of all movies.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>GET /movies/:title</strong><br />Returns a specific movie by title.<br /></td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>GET /movies/directors/all</strong><br />Returns a list of all directors.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>GET /movies/directors/:name</strong><br />Returns a specific director by name.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>GET /movies/genres/all</strong><br />Returns a list of all genres.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>GET /movies/genres/:name</strong><br />Returns a specific genre by name.</td>
            <td>N/A</td>
          </tr>

          <!-- Users Section Header -->
          <tr class="section-header">
            <td colspan="2">User Endpoints</td>
          </tr>
          <tr>
            <td><strong>POST /users</strong><br />Register a new user.</td>
            <td>
              <pre><code>{
  "username": "newUser",  <span class="blue-text">// At least 5 characters.</span>
  "password": "Password123!",  <span class="blue-text">// At least one number, one lowercase, one uppercase, and a special character.</span>
  "email": "newuser@example.com",
  "birthday": "1990-01-01"
}</code></pre>
            </td>
          </tr>
          <tr>
            <td><strong>PUT /users/:username</strong><br />Update user details.</td>
            <td>
              <pre><code>{
  "username": "updatedUser",
  "email": "updateduser@example.com",
  "birthday": "1991-02-01"
}</code></pre>
            </td>
          </tr>
          <tr>
            <td><strong>DELETE /users/:username</strong><br />Delete a user account.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>PUT /users/:username/:movieId</strong><br />Add a favorite movie to a user.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><strong>DELETE /users/:username/:movieId</strong><br />Remove a favorite movie from a user.</td>
            <td>N/A</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h2 id="authentication">Authentication</h2>
    <p>
      The app uses JWT authentication. Users must log in to receive a token, which is then included in the
      <code>Authorization</code> header of all requests as a Bearer token.
    </p>
    <p>
      For added security, user passwords are hashed before being stored in the database using a strong hashing algorithm
      (such as bcrypt). This ensures that even if the database were compromised, plaintext passwords would not be
      exposed.
    </p>

    <h3>JWT Example</h3>
    <pre><code>Authorization: Bearer YOUR_TOKEN_HERE</code></pre>

    <h3>Passport Strategy</h3>
    <p>
      Passport.js is used for handling the authentication logic, leveraging local strategies for username/password
      authentication and JWT strategies for protecting routes.
    </p>
  </body>
</html>
